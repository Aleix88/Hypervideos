"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}var HTMLManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"createElement",value:function(e,n,t){var o=document.createElement(e);return Array.isArray(n)&&n.length>0&&n.forEach(function(e){o.classList.add(e)}),null!=t&&(o.id=t),o}},{key:"getShadowElementByID",value:function(e,n){return document.getElementById(e).shadowRoot.getElementById(n)}},{key:"getShadowElementByClassName",value:function(e,n){return document.getElementById(e).shadowRoot.querySelector("."+n)}}]),e}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var Hypervideo=function(){function e(n,t,o){_classCallCheck(this,e),this.videoURL=n,this.videoType=t,this.containerID=o}return _createClass(e,[{key:"isDOMLoaded",value:function(){return null!=document&&("interactive"===document.readyState||"complete"===document.readyState)}},{key:"setupHypervideo",value:function(e){var n=document.getElementById(this.containerID);n.attachShadow({mode:"open"}),n.shadowRoot.appendChild(this.getStyle()),this.isDOMLoaded()||console.log("Error: Can't setup an hypervideo if DOM is not loaded."),this.tagsJSON=e,new HypervideoControlls(this.videoURL,this.videoType,this.containerID).createSkeleton()}},{key:"getStyle",value:function(){var e=document.createElement("style");return e.textContent='\n        video {\n            width: 100%;\n            height: 100%;\n        }\n        \n        button {\n            cursor: pointer;\n        }\n        \n        .youtube-frame {\n            width: 100%;\n            height: 100%;\n        }\n        \n        .hypervideo-container {\n            position: relative;\n            width: 100%;\n            height: 100%;\n        }\n        \n        /* Top control bar */\n        .top-controller {\n            background-color: rgba(0, 150, 0, 0.37);;\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n        }\n        \n        /*  Bottom control bar  */\n        .bottom-controller {\n            display: flex;\n            justify-content: flex-start;\n            position: absolute;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background-color: rgba(255, 255, 255, 0.521);\n            padding: 4px;\n        }\n        \n        .control-button-container {\n            background: white;\n            height: 2em;\n            padding-left: 0.4em;\n            padding-right: 0.4em;\n            border: 0.3px solid black;\n            cursor: pointer;\n        }\n        \n        .control-button-container:not(:last-child) {\n            margin-right: 2px;\n        }\n        \n        .control-button-container:hover,\n        .control-button-container:focus {\n            background: lightgray;\n        }\n        \n        .control-button {\n            color: black;  \n            border: none;\n            outline: none;\n            background-color: rgba(0,0,0,0);\n            height: 100%; \n            width: 2em;\n            margin: auto;\n            padding: 0;\n        }\n        \n        .control-button:hover,\n        .control-button:focus {\n            color: rgb(97, 87, 245);\n        }\n        \n        .progress-container {\n            flex-grow: 1;\n            margin-right: 2px;\n            height: 10px;\n            background: red;\n            align-self: center;\n        }\n        \n        \n        /* ICONS */\n        \n        .gg-play-button {\n            box-sizing: border-box;\n            position: relative;\n            display: block;\n            transform: scale(var(--ggs,1));\n            width: 22px;\n            height: 22px;\n            margin: auto; /*Aquesta linia s\'ha d\'afegir*/\n        }\n        .gg-play-button::before {\n            content: "";\n            display: block;\n            box-sizing: border-box;\n            position: absolute;\n            width: 0;\n            height: 10px;\n            border-top: 5px solid transparent;\n            border-bottom: 5px solid transparent;\n            border-left: 6px solid;\n            top: 6px;\n            left: 9px;\n        }\n        \n        .gg-repeat {\n            box-sizing: border-box;\n            position: relative;\n            display: block;\n            transform: scale(var(--ggs,1));\n            box-shadow:\n                -2px -2px 0 0,\n                2px 2px 0 0;\n            width: 14px;\n            height: 6px;\n            margin: auto;\n        }\n        .gg-repeat::after,\n        .gg-repeat::before {\n            content: "";\n            display: block;\n            box-sizing: border-box;\n            position: absolute;\n            width: 0;\n            height: 0;\n            border-top: 3px solid transparent;\n            border-bottom: 3px solid transparent;\n        }\n        .gg-repeat::before {\n            border-left: 5px solid;\n            top: -4px;\n            right: 0;\n        }\n        .gg-repeat::after {\n            border-right: 5px solid;\n            bottom: -4px;\n            left: 0;\n        }\n        .gg-maximize {\n            box-sizing: border-box;\n            position: relative;\n            display: block;\n            transform: scale(var(--ggs,1));\n            width: 14px;\n            height: 14px;\n            box-shadow:\n                -6px -6px 0 -4px,\n                6px 6px 0 -4px,\n                6px -6px 0 -4px,\n                -6px 6px 0 -4px;\n            margin: auto;\n        }\n        \n        .gg-minimize {\n            box-sizing: border-box;\n            position: relative;\n            display: block;\n            transform: scale(var(--ggs,1));\n            width: 4px;\n            height: 4px;\n            box-shadow:\n                -8px -4px 0 -1px,\n                -6px -4px 0 -1px,\n                8px 4px 0 -1px,\n                6px 4px 0 -1px,\n                8px -4px 0 -1px,\n                6px -4px 0 -1px,\n                -8px 4px 0 -1px,\n                -6px 4px 0 -1px;\n            margin: auto;\n        }\n        .gg-minimize::after,\n        .gg-minimize::before {\n            content: "";\n            display: block;\n            box-sizing: border-box;\n            position: absolute;\n            width: 2px;\n            height: 18px;\n            border-top: 6px solid;\n            border-bottom: 6px solid;\n            box-shadow: 18px 0 0 -2px;\n            top: -7px;\n        }\n        .gg-minimize::after {\n            left: -3px;\n        }\n        .gg-minimize::before {\n            right: -3px;\n        }\n        \n        .gg-volume {\n            box-sizing: border-box;\n            position: relative;\n            display: block;\n            transform: scale(var(--ggs,1));\n            width: 8px;\n            height: 8px;\n            border: 2px solid;\n            border-right: 0;\n            -webkit-perspective: 12px;\n            perspective: 12px;\n            border-top-left-radius: 4px;\n            border-bottom-left-radius: 4px;\n            margin: 0;\n        }\n        .gg-volume::after,\n        .gg-volume::before {\n            content: "";\n            display: block;\n            box-sizing: border-box;\n            position: absolute;\n        }\n        .gg-volume::before {\n            left: 2px;\n            transform: rotateY(-90deg);\n            width: 10px;\n            height: 10px;\n            border: 2px solid;\n            border-left: 0;\n            top: -3px;\n        }\n        .gg-volume::after {\n            width: 8px;\n            height: 16px;\n            border: 6px double;\n            border-left: 0;\n            border-top-right-radius: 100px;\n            border-bottom-right-radius: 100px;\n            right: -14px;\n            top: -6px;\n        }\n        \n        .gg-play-pause {\n            box-sizing: border-box;\n            position: relative;\n            display: block;\n            transform: scale(var(--ggs,1));\n            width: 8px;\n            height: 10px;\n            border-left: 3px solid;\n            border-right: 3px solid;\n            margin: auto;\n        }\n        ',e}}]),e}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}_defineProperty(Hypervideo,"YOUTUBE_TYPE","YOUTUBE"),_defineProperty(Hypervideo,"VIDEO_TYPE","VIDEO");var HypervideoControlls=function(){function e(n,t,o){_classCallCheck(this,e),this.videoSRC=n,this.videoType=t,this.containerID=o,this.isVideoPaused=!0,this.htmlManager=new HTMLManager}return _createClass(e,[{key:"setVolume",value:function(e){e=(e=e>1?1:e)<0?0:e,this.htmlManager.getShadowElementByID(this.containerID,this.videoElementID).volume=e}},{key:"pauseVideo",value:function(){this.htmlManager.getShadowElementByID(this.containerID,this.videoElementID).pause(),this.changeButtonIcon("control-play-button","gg-play-button"),this.isVideoPaused=!0}},{key:"playVideo",value:function(){this.htmlManager.getShadowElementByID(this.containerID,this.videoElementID).play(),this.changeButtonIcon("control-play-button","gg-play-pause"),this.isVideoPaused=!1}},{key:"setVideoCurrentTime",value:function(e){this.htmlManager.getShadowElementByID(this.containerID,this.videoElementID).currentTime=e}},{key:"restartVideo",value:function(){this.setVideoCurrentTime(0)}},{key:"isFullScreen",value:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}},{key:"requestFullScreen",value:function(e){e.requestFullscreen?(e.requestFullscreen(),this.changeButtonIcon("control-full-screen-button","gg-minimize")):e.mozRequestFullScreen?(e.mozRequestFullScreen(),this.changeButtonIcon("control-full-screen-button","gg-minimize")):e.webkitRequestFullscreen?(e.webkitRequestFullscreen(),this.changeButtonIcon("control-full-screen-button","gg-minimize")):e.msRequestFullscreen&&(e.msRequestFullscreen(),this.changeButtonIcon("control-full-screen-button","gg-minimize"))}},{key:"requestExitFullScreen",value:function(e){document.exitFullscreen?(document.exitFullscreen(),this.changeButtonIcon("control-full-screen-button","gg-maximize")):document.mozCancelFullScreen?(document.mozCancelFullScreen(),this.changeButtonIcon("control-full-screen-button","gg-maximize")):document.webkitExitFullscreen&&(document.webkitExitFullscreen(),this.changeButtonIcon("control-full-screen-button","gg-maximize"))}},{key:"toggleFullScreen",value:function(){var e=document.getElementById(this.containerID);this.isFullScreen()?this.requestExitFullScreen(e):this.requestFullScreen(e)}},{key:"playButtonClicked",value:function(){this.isVideoPaused?this.playVideo():this.pauseVideo()}},{key:"changeButtonIcon",value:function(e,n){var t=this.htmlManager.getShadowElementByClassName(this.containerID,e);if(!(t.length<=0)){var o=t.getElementsByTagName("i");o.length<=0||(o[0].className=n)}}},{key:"createSkeleton",value:function(){var e=document.getElementById(this.containerID).shadowRoot,n=this.htmlManager.createElement("div",["hypervideo-container"]),t=this.htmlManager.createElement("div",["tags-container"]);e.appendChild(n),this.addVideoElement(n),this.videoType!=Hypervideo.YOUTUBE_TYPE&&this.addTopBarControlls(n),n.appendChild(t),this.addBottomBarControlls(n)}},{key:"addVideoTag",value:function(e){this.videoElementID="video-"+this.containerID;var n=this.htmlManager.createElement("video","",this.videoElementID);n.src=this.videoSRC,e.appendChild(n)}},{key:"addVideoFromYotube",value:function(e){var n=this.htmlManager.createElement("iframe",["youtube-frame"]),t=this.videoSRC;t+="?autoplay=0&controls=0&showinfo=0&disablekb=1&fs=0&playsinline=1&wmode=opaque&iv_load_policy=3&modestbranding=1&rel=0",n.src=t,n.frameBorder=0,e.appendChild(n)}},{key:"addVideoElement",value:function(e){switch(this.videoType){case Hypervideo.YOUTUBE_TYPE:this.addVideoFromYotube(e);break;default:this.addVideoTag(e)}}},{key:"addTopBarControlls",value:function(e){var n=this.htmlManager.createElement("div",["top-controller"]);e.appendChild(n)}},{key:"addBottomBarControlls",value:function(e){var n=this.htmlManager.createElement("div",["bottom-controller"]);e.appendChild(n);var t=this.createControlButton("control-play-button","gg-play-button",this.playButtonClicked),o=this.createControlButton("control-repeat-button","gg-repeat",this.restartVideo),r=this.createControlButton("control-full-screen-button","gg-maximize",this.toggleFullScreen),i=this.createControlButton("control-volume-button","gg-volume"),a=this.createProgressBar();n.appendChild(t),n.appendChild(o),n.appendChild(r),n.appendChild(a),n.appendChild(i)}},{key:"createControlButton",value:function(e,n,t){var o=this.htmlManager.createElement("div",["control-button-container"]),r=this.htmlManager.createElement("button",["control-button",e]),i=this.htmlManager.createElement("i",[n]);return o.appendChild(r),r.appendChild(i),null!=t&&o.addEventListener("click",t.bind(this)),o}},{key:"createProgressBar",value:function(){return this.htmlManager.createElement("div",["progress-container"])}}]),e}();function includeJs(e,n){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.onreadystatechange=n,t.onload=n,document.body.appendChild(t)}var files=["../../API/src/HTMLManager.js","../../API/src/HypervideoControlls.js","../../API/src/Hypervideo.js"],scriptsLoaded=0;function importHypervideoAPI(e){files.forEach(function(n){includeJs(n,function(){++scriptsLoaded===files.length&&e()})})}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var ProgressBar=function e(){_classCallCheck(this,e)};