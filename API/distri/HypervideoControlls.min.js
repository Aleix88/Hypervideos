"use strict";function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var HypervideoControlls=function(){function e(t,n,r,a,o){_classCallCheck(this,e),this.videoLength=null,this.containerID=r,this.videoSRC=t,this.videoManager=a,this.videoType=n,this.tags=o,this.htmlManager=new HTMLManager,this.videoManager.videoStateChanged=this.__videoStateChanged.bind(this)}return _createClass(e,[{key:"__videoStateChanged",value:function(e,t){var n=document.getElementById(this.containerID).querySelector("x-progress-bar"),r=document.getElementById(this.containerID).querySelector("x-pause-screen"),a=document.getElementById(this.containerID).querySelector("x-volume-bar");switch(e){case VideoManager.PLAYING:r.hide(),this.changeButtonIcon("control-play-button","gg-play-pause");break;case VideoManager.PAUSED:r.show(),this.changeButtonIcon("control-play-button","gg-play-button");break;case VideoManager.LOADED:if(a.setVolume(50),this.videoManager.setVolume(.5),this.videoLength=t.duration,null===n)break;n.setMaxLength(t.duration),this.__setProgressBarTimestamps();break;case VideoManager.ENTER_FULL_SCREEN:this.changeButtonIcon("control-full-screen-button","gg-minimize");break;case VideoManager.EXIT_FULL_SCREEN:this.changeButtonIcon("control-full-screen-button","gg-maximize")}}},{key:"restartVideo",value:function(){document.getElementById(this.containerID).querySelector("x-progress-bar").setCurrentLength(0),this.videoManager.restartVideo()}},{key:"toggleFullScreen",value:function(){this.videoManager.toggleFullScreen()}},{key:"playButtonClicked",value:function(){console.log("Click play"),this.videoManager.isVideoPlaying()?this.videoManager.pause():this.videoManager.play()}},{key:"changeButtonIcon",value:function(e,t){var n=document.getElementById(this.containerID).querySelector("."+e);if(!(n.length<=0)){var r=n.getElementsByTagName("i");r.length<=0||(r[0].className=t)}}},{key:"createSkeleton",value:function(){var e=document.getElementById(this.containerID),t=this.htmlManager.createElement("div",["hypervideo-container"]),n=this.htmlManager.createElement("div",["tags-container"]);e.appendChild(t),this.addVideoElement(t),this.videoType!=Hypervideo.YOUTUBE_TYPE&&this.addTopBarControlls(t),this.__addPauseScreen(t),t.appendChild(n),this.addBottomBarControlls(t)}},{key:"addVideoTag",value:function(e){this.videoElementID="video-"+this.containerID;var t=this.htmlManager.createElement("video","",this.videoElementID);t.src=this.videoSRC,e.appendChild(t),this.videoManager.setupVideo()}},{key:"addVideoFromYotube",value:function(e){this.videoElementID="video-"+this.containerID;var t=this.htmlManager.createElement("div",["youtube-frame"]);t.id=this.videoElementID,e.appendChild(t),this.videoManager.addYoutubeScript(this.videoElementID)}},{key:"addVideoElement",value:function(e){switch(this.videoType){case Hypervideo.YOUTUBE_TYPE:this.addVideoFromYotube(e);break;default:this.addVideoTag(e)}}},{key:"addTopBarControlls",value:function(e){var t=this.htmlManager.createElement("div",["top-controller"]);e.appendChild(t)}},{key:"__addPauseScreen",value:function(e){var t=this.htmlManager.createElement("x-pause-screen"),n=this;t.didClick=function(){n.videoManager.isVideoPlaying()?n.videoManager.pause():n.videoManager.play()},e.appendChild(t)}},{key:"addBottomBarControlls",value:function(e){var t=this.htmlManager.createElement("div",["bottom-controller"]);e.appendChild(t);var n=this.createControlButton("control-play-button","gg-play-button",this.playButtonClicked),r=this.createControlButton("control-repeat-button","gg-repeat",this.restartVideo),a=this.createControlButton("control-full-screen-button","gg-maximize",this.toggleFullScreen),o=this.createProgressBar(),i=this.createVolumeBar();t.appendChild(n),t.appendChild(r),t.appendChild(a),t.appendChild(o),t.appendChild(i)}},{key:"createControlButton",value:function(e,t,n){var r=this.htmlManager.createElement("div",["control-button-container"]),a=this.htmlManager.createElement("button",["control-button",e]),o=this.htmlManager.createElement("i",[t]);return r.appendChild(a),a.appendChild(o),null!=n&&r.addEventListener("click",n.bind(this)),r}},{key:"createProgressBar",value:function(){var e=this.htmlManager.createElement("x-progress-bar",["progress-container"]);return e.progressBarChanged=this.__progressBarChanged.bind(this),null!==this.videoLength&&e.setMaxLength(this.videoLength),this.__setupProgressBarTimer(e),e}},{key:"__setupProgressBarTimer",value:function(e){var t=new Observer(function(){e.increment()});this.videoManager.addObserver(t)}},{key:"__progressBarChanged",value:function(e){this.videoManager.loadProgress(e)}},{key:"__setProgressBarTimestamps",value:function(){var e,t=document.getElementById(this.containerID).querySelector("x-progress-bar"),n=_createForOfIteratorHelper(this.tags);try{for(n.s();!(e=n.n()).done;){var r=e.value.timeConfig.timestamp;t.addMarkerAt(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"createVolumeBar",value:function(){var e=this.htmlManager.createElement("x-volume-bar",["volume-bar"]);return e.volumeChanged=this.__volumeChanged.bind(this),e}},{key:"__volumeChanged",value:function(e){this.videoManager.setVolume(e/100)}}]),e}();