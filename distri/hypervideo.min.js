"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)})(e)}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&_setPrototypeOf(a,n.prototype),a}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Plugin=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"onLoad",value:function(e,t,n,i){this.config=e,this.container=t,this.elementsContainer=n,this.videoManager=i,this.__firstClick=!1,this.isTagVisible=!1}},{key:"tagWillAppear",value:function(){}},{key:"tagWillDisappear",value:function(){}},{key:"onTagClick",value:function(e){var t=this;!1===this.__firstClick&&(this.elementsContainer.addEventListener("click",function(e){t.elementsContainer===e.target&&t.hideElementsContainer()}),this.__firstClick=!0)}},{key:"onTagHover",value:function(e){}},{key:"onTagLeave",value:function(e){}},{key:"fullScreenStateChanged",value:function(e){}},{key:"showElementsContainer",value:function(){this.elementsContainer.parentElement.style.display="block",this.elementsContainer.style.display="block"}},{key:"hideElementsContainer",value:function(){this.elementsContainer.parentElement.style.display="none",this.elementsContainer.style.display="none"}}]),e}(),VideoTimer=function(){function e(t){_classCallCheck(this,e),this.timeHandler=t,this.timer=null,this.isPlaying=!1}return _createClass(e,[{key:"play",value:function(){!0!==this.isPlaying&&(this.timer=setInterval(this.__handleTime.bind(this),e.LOOP_TIME),this.isPlaying=!0)}},{key:"pause",value:function(){clearInterval(this.timer),this.isPlaying=!1}},{key:"__handleTime",value:function(){this.timeHandler()}}],[{key:"LOOP_TIME",get:function(){return 100}}]),e}(),Observer=function(){function e(t){_classCallCheck(this,e),this.onChange=t}return _createClass(e,[{key:"update",value:function(e){this.onChange(e)}}]),e}(),Subject=function(){function e(){_classCallCheck(this,e),this.observers=[]}return _createClass(e,[{key:"addObserver",value:function(e){this.observers.push(e)}},{key:"removeObserver",value:function(e){var t=this.observers.findIndex(function(t){return e===t});-1!==t&&(this.observers=this.observers.slice(t,1))}},{key:"notify",value:function(e){this.observers.forEach(function(t){return t.update(e)})}}]),e}(),MediaManager=function(e){_inherits(n,Subject);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this)).containerID=e,i.mediaStateChanged=null,i.isFullScreen=!1,i.__fullScreenEventListeners(),i}return _createClass(n,[{key:"__fullScreenEventListeners",value:function(){document.addEventListener("fullscreenchange",this._fullScreenChangeHandler.bind(this),!1),document.addEventListener("mozfullscreenchange",this._fullScreenChangeHandler.bind(this),!1),document.addEventListener("MSFullscreenChange",this._fullScreenChangeHandler.bind(this),!1),document.addEventListener("webkitfullscreenchange",this._fullScreenChangeHandler.bind(this),!1)}},{key:"_fullScreenChangeHandler",value:function(e){e.target.id===this.containerID&&(document.fullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement?(this.isFullScreen=!0,this.mediaStateChanged(n.ENTER_FULL_SCREEN)):(this.isFullScreen=!1,this.mediaStateChanged(n.EXIT_FULL_SCREEN)))}},{key:"toggleFullScreen",value:function(){var e=document.getElementById(this.containerID);this.isFullScreen?this.requestExitFullScreen(e):this.requestFullScreen(e)}},{key:"requestFullScreen",value:function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"requestExitFullScreen",value:function(e){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}]),n}();_defineProperty(MediaManager,"PLAYING",0),_defineProperty(MediaManager,"PAUSED",1),_defineProperty(MediaManager,"LOADED",2),_defineProperty(MediaManager,"ENTER_FULL_SCREEN",3),_defineProperty(MediaManager,"EXIT_FULL_SCREEN",4);var VideoTagManager=function(e){_inherits(n,MediaManager);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).videoTimer=new VideoTimer(i.__timeHandler.bind(_assertThisInitialized(i))),i}return _createClass(n,[{key:"play",value:function(){document.getElementById(this.containerID).querySelector("video").play()}},{key:"pause",value:function(){document.getElementById(this.containerID).querySelector("video").pause()}},{key:"restartVideo",value:function(){this.loadProgress(0)}},{key:"isVideoPlaying",value:function(){return!document.getElementById(this.containerID).querySelector("video").paused}},{key:"seekTo",value:function(e){var t=document.getElementById(this.containerID).querySelector("video");t.currentTime=e,this.notify(1e3*t.currentTime)}},{key:"getVideoDuration",value:function(){return document.getElementById(this.containerID).querySelector("video").duration}},{key:"loadProgress",value:function(e){var t=document.getElementById(this.containerID).querySelector("video");t.currentTime=t.duration*e,this.notify(1e3*t.currentTime)}},{key:"setupVideo",value:function(){var e=document.getElementById(this.containerID).querySelector("video");e.addEventListener("pause",this.__videoIsPaused.bind(this)),e.addEventListener("play",this.__videoIsPlaying.bind(this)),e.addEventListener("loadeddata",this.__videoLoaded.bind(this))}},{key:"__videoIsPlaying",value:function(){this.mediaStateChanged(MediaManager.PLAYING),this.videoTimer.play()}},{key:"__videoIsPaused",value:function(){this.mediaStateChanged(MediaManager.PAUSED),this.videoTimer.pause()}},{key:"__videoLoaded",value:function(){var e=document.getElementById(this.containerID).querySelector("video");this.mediaStateChanged(MediaManager.LOADED,{duration:e.duration})}},{key:"__timeHandler",value:function(){var e=document.getElementById(this.containerID).querySelector("video");this.notify(1e3*e.currentTime)}},{key:"setVolume",value:function(e){e=(e=e>1?1:e)<0?0:e,document.getElementById(this.containerID).querySelector("video").volume=e}},{key:"currentTime",get:function(){return document.getElementById(this.containerID).querySelector("video").currentTime}}]),n}(),YoutubeVideoManager=function(e){_inherits(n,MediaManager);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).player=null,i.firstTimePlaying=!0,i.videoTimer=new VideoTimer(i.__timeHandler.bind(_assertThisInitialized(i))),i}return _createClass(n,[{key:"play",value:function(){null!==this.player&&this.player.playVideo()}},{key:"pause",value:function(){null!==this.player&&this.player.pauseVideo()}},{key:"restartVideo",value:function(){this.__loadTime(0)}},{key:"isVideoPlaying",value:function(){if(null!==this.player)return this.player.getPlayerState()==YT.PlayerState.PLAYING}},{key:"seekTo",value:function(e){null!==this.player&&this.__loadTime(e)}},{key:"loadProgress",value:function(e){if(null!==this.player){var t=this.player.getDuration();this.__loadTime(t*e)}}},{key:"__loadTime",value:function(e){if(null!==this.player){this.player.seekTo(e,!0);this.player.getCurrentTime();this.notify(1e3*e)}}},{key:"setVolume",value:function(e){null!==this.player&&(e=(e=e>1?1:e)<0?0:e,this.player.setVolume(100*e))}},{key:"addYoutubeScript",value:function(e,t){this.iframeContainerID=e,this.videoID=t;var n=document.createElement("script");n.src="https://www.youtube.com/iframe_api",document.getElementsByTagName("script")[0].appendChild(n),window.onYouTubeIframeAPIReady=this.__onYouTubeIframeAPIReady.bind(this)}},{key:"getVideoDuration",value:function(){return this.player.getDuration()}},{key:"__onYouTubeIframeAPIReady",value:function(){var e=new YT.Player(this.iframeContainerID,{height:"360",width:"640",videoId:this.videoID,events:{onReady:this.__onPlayerReady.bind(this),onStateChange:this.__onPlayerStateChange.bind(this)},playerVars:{autoplay:0,controls:0,disablekb:1,fs:0,playsinline:1,modestbranding:1,rel:0,iv_load_policy:3,autohide:1,wmode:"opaque",start:0}});this.player=e}},{key:"__onPlayerReady",value:function(e){document.querySelector("#"+this.iframeContainerID).style.pointerEvents="none",this.mediaStateChanged(MediaManager.LOADED,{duration:this.player.getDuration()})}},{key:"__onPlayerStateChange",value:function(e){e.data==YT.PlayerState.PLAYING?(!0===this.firstTimePlaying&&this.player.getCurrentTime()>=.1&&this.__loadTime(0),this.mediaStateChanged(MediaManager.PLAYING),this.videoTimer.play(),this.firstTimePlaying=!1):e.data==YT.PlayerState.PAUSED&&(this.mediaStateChanged(MediaManager.PAUSED),this.videoTimer.pause())}},{key:"__timeHandler",value:function(){this.notify(1e3*this.player.getCurrentTime())}},{key:"currentTime",get:function(){if(null!==this.player)return this.player.getCurrentTime()}}]),n}(),HTMLManager=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"createElement",value:function(e,t){var n=document.createElement(e);if(null==t)return n;if(null!=t.classList&&Array.isArray(t.classList)&&t.classList.length>0&&t.classList.forEach(function(e){n.classList.add(e)}),null!=t.id&&(n.id=t.id),null!=t.src&&(n.src=t.src),null!=t.href&&(n.href=t.href),null!=t.textContent&&(n.textContent=t.textContent),null!=t.style)for(var i=0,a=Object.keys(t.style);i<a.length;i++){var r=a[i];void 0!==n.style[r]&&(n.style[r]=t.style[r])}return n}},{key:"hexToRGBA",value:function(e,t){var n=parseInt(e.slice(1,3),16),i=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);return n=isNaN(n)?255:n,e.length<=4&&(i=n,a=n),"rgba("+n+", "+i+", "+a+", "+t+")"}},{key:"isDesktopBrowser",value:function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),!t}}]),e}(),TouchEventsManager=function(){function e(){_classCallCheck(this,e),this.htmlManager=new HTMLManager}return _createClass(e,[{key:"touchStart",value:function(t,n){var i=!0===this.htmlManager.isDesktopBrowser()?"mousedown":"touchstart",a=!0===this.htmlManager.isDesktopBrowser()?e.IS_CLICK_EVENT:e.IS_TOUCH_EVENT;t.addEventListener(i,function(e){n(a,e)})}},{key:"touchEnd",value:function(t,n){var i=!0===this.htmlManager.isDesktopBrowser()?"mouseup":"touchend",a=!0===this.htmlManager.isDesktopBrowser()?e.IS_CLICK_EVENT:e.IS_TOUCH_EVENT;t.addEventListener(i,function(e){n(a,e)})}},{key:"touchLeave",value:function(t,n){var i=!0===this.htmlManager.isDesktopBrowser()?"mouseleave":"touchcancel",a=!0===this.htmlManager.isDesktopBrowser()?e.IS_CLICK_EVENT:e.IS_TOUCH_EVENT;t.addEventListener(i,function(e){n(a,e)})}},{key:"touchMove",value:function(t,n){var i=!0===this.htmlManager.isDesktopBrowser()?"mousemove":"touchmove",a=!0===this.htmlManager.isDesktopBrowser()?e.IS_CLICK_EVENT:e.IS_TOUCH_EVENT;t.addEventListener(i,function(e){n(a,e)})}}]),e}();_defineProperty(TouchEventsManager,"IS_TOUCH_EVENT",0),_defineProperty(TouchEventsManager,"IS_CLICK_EVENT",1);var ControlButton=function(){function e(t){_classCallCheck(this,e),this.htmlManager=new HTMLManager,this.containerID=t}return _createClass(e,[{key:"createControlButton",value:function(e,t,n){var i=this.htmlManager.createElement("div",{classList:["control-button-container"]}),a=this.htmlManager.createElement("button",{classList:["control-button",e]}),r=this.htmlManager.createElement("i",{classList:[t]});return i.appendChild(a),a.appendChild(r),null!=n&&i.addEventListener("click",n),i}},{key:"changeButtonIcon",value:function(e,t){var n=document.getElementById(this.containerID).querySelector("."+e);if(!(n.length<=0)){var i=n.getElementsByTagName("i");i.length<=0||(i[0].className=t)}}}]),e}(),XFullScreenButton=function(e){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){var e;_classCallCheck(this,n),(e=t.call(this)).clickHandler=null,e.htmlManager=new HTMLManager;var i=e.attachShadow({mode:"open"}),a=e.__createButton();return i.append(a),i.appendChild(e.__getStyle()),e}return _createClass(n,[{key:"__createButton",value:function(){var e=this.htmlManager.createElement("div",{classList:["fs-button-container"]});return e.addEventListener("click",this.__buttonClicked.bind(this)),this.icon=this.htmlManager.createElement("i",{classList:["gg-maximize"]}),e.appendChild(this.icon),e}},{key:"__buttonClicked",value:function(e){this.clickHandler(e)}},{key:"isFullScreenActive",value:function(e){!0===e?(this.icon.classList.remove("gg-maximize"),this.icon.classList.add("gg-minimize")):(this.icon.classList.remove("gg-minimize"),this.icon.classList.add("gg-maximize"))}},{key:"__getStyle",value:function(){var e=document.createElement("style");return e.textContent='\n        \n            .fs-button-container {\n                background: lightgray;\n                border-radius: 5px;\n                cursor: pointer;\n                width: 35px;\n                height: 35px;\n                display:flex;\n            }\n\n            .fs-button-container:focus,\n            .fs-button-container:hover {\n                background: darkgray;\n            }\n\n            .gg-maximize {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 14px;\n                height: 14px;\n                box-shadow:\n                    -6px -6px 0 -4px,\n                    6px 6px 0 -4px,\n                    6px -6px 0 -4px,\n                    -6px 6px 0 -4px;\n                margin: auto;\n            }\n            \n            .gg-minimize {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 4px;\n                height: 4px;\n                box-shadow:\n                    -8px -4px 0 -1px,\n                    -6px -4px 0 -1px,\n                    8px 4px 0 -1px,\n                    6px 4px 0 -1px,\n                    8px -4px 0 -1px,\n                    6px -4px 0 -1px,\n                    -8px 4px 0 -1px,\n                    -6px 4px 0 -1px;\n                margin: auto;\n            }\n            .gg-minimize::after,\n            .gg-minimize::before {\n                content: "";\n                display: block;\n                box-sizing: border-box;\n                position: absolute;\n                width: 2px;\n                height: 18px;\n                border-top: 6px solid;\n                border-bottom: 6px solid;\n                box-shadow: 18px 0 0 -2px;\n                top: -7px;\n            }\n            .gg-minimize::after {\n                left: -3px;\n            }\n            .gg-minimize::before {\n                right: -3px;\n            }\n\n        ',e}}]),n}();customElements.define("x-full-screen-button",XFullScreenButton);var XPauseScreen=function(e){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){var e;_classCallCheck(this,n),(e=t.call(this)).htmlManager=new HTMLManager,e.clickHandler=null;var i=e.attachShadow({mode:"open"}),a=e.htmlManager.createElement("div",{classList:["pause-container"]});return a.addEventListener("click",e.__onClick.bind(_assertThisInitialized(e))),i.appendChild(a),i.appendChild(e.__getStyle()),e}return _createClass(n,[{key:"__onClick",value:function(){this.clickHandler()}},{key:"__getStyle",value:function(){var e=document.createElement("style");return e.textContent="\n\n            .pause-container {\n                width: 100%;\n                height: 100%;\n                background: rgba(0,0,0,0.1);\n                cursor: pointer;\n                display: flex;\n                margin: 0;\n            }\n\n            .play-image {\n                width: 100px;\n                height: 100px;\n                margin: auto;\n            }\n        ",e}}]),n}();customElements.define("x-pause-screen",XPauseScreen);var XProgressBar=function(e){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){var e;_classCallCheck(this,n),(e=t.call(this)).isMoving=!1,e.htmlManager=new HTMLManager,e.maxLength=100,e.currentLength=0,e.currentProgress=0,e.progressBarChanged=null;var i=e.attachShadow({mode:"open"});e.__setupEventsListeners();var a=e.htmlManager.createElement("div",{classList:["progress-bar"]});return i.appendChild(e.__getStyle()),i.appendChild(a),e}return _createClass(n,[{key:"addMarkerAt",value:function(e){var t=this.htmlManager.createElement("div",{classList:["progress-bar-marker"]}),n=this.__convertLengthToProgress(e);this.shadowRoot.appendChild(t),t.style.left=n+"%"}},{key:"__setupEventsListeners",value:function(){var e=new TouchEventsManager;e.touchStart(this,this.__mouseDown.bind(this)),e.touchEnd(document,this.__mouseUp.bind(this)),e.touchLeave(document,this.__mouseLeave.bind(this)),e.touchMove(document,this.__mouseMoving.bind(this))}},{key:"__recalculatePosition",value:function(e){var t=this.getBoundingClientRect(),n=(e-t.left)/t.width;n=(n=n>1?1:n)<0?0:n,this.setCurrentLength(n*this.maxLength)}},{key:"__mouseLeave",value:function(e,t){if(this.isMoving){this.isMoving=!1;var n=e===TouchEventsManager.IS_TOUCH_EVENT?t.changedTouches[0].clientX:t.clientX;this.__recalculatePosition(n),this.progressBarChanged(this.currentProgress)}}},{key:"__mouseUp",value:function(e,t){if(this.isMoving){this.isMoving=!1;var n=e===TouchEventsManager.IS_TOUCH_EVENT?t.changedTouches[0].clientX:t.clientX;this.__recalculatePosition(n),this.progressBarChanged(this.currentProgress)}}},{key:"__mouseMoving",value:function(e,t){if(this.isMoving){var n=e===TouchEventsManager.IS_TOUCH_EVENT?t.touches[0].clientX:t.clientX;this.__recalculatePosition(n)}}},{key:"__mouseDown",value:function(e,t){this.isMoving=!0;var n=e===TouchEventsManager.IS_TOUCH_EVENT?t.touches[0].clientX:t.clientX;this.__recalculatePosition(n)}},{key:"__convertLengthToProgress",value:function(e){return Math.round(parseFloat(e)/parseFloat(this.maxLength)*100)}},{key:"setCurrentLength",value:function(e){this.currentLength=e,this.currentLength=this.currentLength>this.maxLength?this.maxLength:this.currentLength,this.currentLength=this.currentLength<0?0:this.currentLength;var t=this.shadowRoot.querySelector(".progress-bar"),n=this.__convertLengthToProgress(e);this.currentProgress=n/100,t.style.width=n+"%"}},{key:"setMaxLength",value:function(e){this.maxLength=e}},{key:"increment",value:function(e){var t=1;null==e||isNaN(e)||(t=e),this.setCurrentLength(this.currentLength+t)}},{key:"__getStyle",value:function(){var e=document.createElement("style");return e.textContent="\n            .progress-bar {\n                background: rgb(97, 87, 245);\n                position: absolute;\n                height: 100%;\n                width: 0%;\n            }\n\n            .progress-bar-marker {\n                width: 7px;\n                height: 100%;\n                top: 0;\n                background: yellow;\n                position: absolute;\n            }\n        ",e}}]),n}();customElements.define("x-progress-bar",XProgressBar);var XTagButton=function(e){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).htmlManager=new HTMLManager,e.attachShadow({mode:"open"}),e.oldIsVisible=!1,e.hoverHandler=null,e.clickHandler=null,e.leaveHandler=null,e.tagCircleContainer=e.htmlManager.createElement("div",{classList:["tag-circle-container"]}),e.anchor=e.htmlManager.createElement("a",{classList:["tag-anchor"]}),e.aspectRatioDiv=e.htmlManager.createElement("div",{classList:["aspect-ratio-div"]}),e.shadowRoot.appendChild(e.tagCircleContainer),e.shadowRoot.appendChild(e.anchor),e.shadowRoot.appendChild(e.aspectRatioDiv),e.shadowRoot.appendChild(e.__getStyle()),e.__setupEventListeners(_assertThisInitialized(e)),e}return _createClass(n,[{key:"__setupEventListeners",value:function(e){e.addEventListener("click",this.__onClick.bind(this)),e.addEventListener("mouseenter",this.__onHover.bind(this)),e.addEventListener("mouseleave",this.__onMouseLeave.bind(this))}},{key:"__onClick",value:function(e){this.clickHandler(e)}},{key:"__onHover",value:function(e){this.__animateFocusScale(),this.hoverHandler(e)}},{key:"__onMouseLeave",value:function(e){this.__animateDefaultScale(),this.leaveHandler(e)}},{key:"__animateDefaultScale",value:function(){this.anchor.classList.add("defaultScale"),this.anchor.classList.remove("focusScale"),this.anchor.classList.remove("appear")}},{key:"__animateFocusScale",value:function(){this.anchor.classList.add("focusScale"),this.anchor.classList.remove("defaultScale"),this.anchor.classList.remove("appear")}},{key:"__animateAppear",value:function(){this.style.visibility="visible",this.anchor.classList.remove("disappear"),this.tagCircleContainer.classList.remove("effectDissapear"),this.anchor.classList.add("appear"),this.tagCircleContainer.classList.add("effectAppear")}},{key:"__animateDisappear",value:function(){var e=this,t=setInterval(function(){e.style.visibility="hidden",clearTimeout(t)},350);this.anchor.classList.remove("appear"),this.tagCircleContainer.classList.remove("effectAppear"),this.anchor.classList.add("disappear"),this.tagCircleContainer.classList.add("effectDissapear")}},{key:"__getStyle",value:function(){var e=document.createElement("style");return e.textContent="\n\n            .aspect-ratio-div {\n                margin-top: 100%;\n            }\n\n            .tag-circle-container {\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                border-radius: 50%;\n                opacity: 0;\n\n                -webkit-transition: opacity 0.3s;\n                -moz-transition: opacity 0.3s;\n                -ms-transition: opacity 0.3s;\n                -o-transition: opacity 0.3s;\n                transition: opacity 0.3s;\n\n                -webkit-animation: crescendo 1.5s alternate infinite ease-in;\n                -moz-animation: crescendo 1.5s alternate infinite ease-in;\n                -ms-animation: crescendo 1.5s alternate infinite ease-in;\n                -o-animation: crescendo 1.5s alternate infinite ease-in;\n                animation: crescendo 1.5s alternate infinite ease-in;\n\n            }\n\n            .tag-circle-container.effectAppear {\n                opacity: 1;\n            }\n\n            .tag-circle-container.effectDissapear {\n                opacity: 0;\n            }\n\n\n            @keyframes crescendo {\n                0% {transform: scale(1);}\n                100% {transform: scale(1.5);}\n            }\n\n            .tag-anchor {\n                display:block;\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                border-radius: 50%;\n                cursor: pointer;\n                transform: scale(0);\n                -webkit-transition: transform 0.3s;\n                -moz-transition: transform 0.3s;\n                -ms-transition: transform 0.3s;\n                -o-transition: transform 0.3s;\n                transition: transform 0.3s;\n            }\n\n            .tag-anchor.defaultScale {\n                transform: scale(1);\n            }\n\n            .tag-anchor.focusScale {\n                transform: scale(1.5);\n            }\n\n            .tag-anchor.disappear {\n                transform: scale(0);\n            }\n\n            .tag-anchor.appear {\n                transform: scale(1);\n            }\n        ",e}},{key:"hexColor",set:function(e){var t=this.shadowRoot.querySelector(".tag-anchor"),n=this.shadowRoot.querySelector(".tag-circle-container"),i=this.htmlManager.hexToRGBA(e,.5);t.style.background=e,n.style.background=i},get:function(){return this.hexColor}},{key:"position",set:function(e){this.style.top=e.y+"%",this.style.left=e.x+"%",this.style.transform="translate(-50%, -50%)"}},{key:"isVisible",set:function(e){this.oldIsVisible!==e&&(!0===e?this.__animateAppear():!1===e&&this.__animateDisappear(),this.oldIsVisible=e)}}]),n}();customElements.define("x-tag-button",XTagButton);var XTimeCounter=function(e){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){var e;_classCallCheck(this,n),(e=t.call(this)).attachShadow({mode:"open"}),e.htmlManager=new HTMLManager,e.currentTime=0;var i=e.htmlManager.createElement("p",{classList:["time-text-element"],textContent:"00:00"});return e.shadowRoot.appendChild(i),e.shadowRoot.appendChild(e.__getStyle()),e}return _createClass(n,[{key:"incrementTime",value:function(){this.currentTime=this.currentTime+1}},{key:"__getStyle",value:function(){var e=document.createElement("style");return e.textContent="\n            .time-text-element {\n                color: white;\n                margin: 0;\n            }\n        ",e}},{key:"currentTime",set:function(e){var t=this.shadowRoot.querySelector(".time-text-element");if(null!=t){var n=Math.floor(e/3600).toString().padStart(2,"0"),i=Math.floor((e-3600*n)/60).toString().padStart(2,"0"),a=n<=0?"":n+":";a+=i+":"+Math.floor(e-3600*n-60*i).toString().padStart(2,"0"),t.textContent=a}}}]),n}();customElements.define("x-time-counter",XTimeCounter);var XVolumeBar=function(e){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){var e;_classCallCheck(this,n),(e=t.call(this)).htmlManager=new HTMLManager,e.maxVolume=100,e.volume=0,e.isVolMoving=!1,e.volumeChanged=function(){};var i=e.attachShadow({mode:"open"}),a=e.htmlManager.createElement("div",{classList:["volume-bar-container"]}),r=e.__createVolumeButton(),o=e.htmlManager.createElement("div",{classList:["volume-bar-rect"]}),s=e.htmlManager.createElement("div",{classList:["volume-bar-level"]});return a.appendChild(r),a.appendChild(o),o.appendChild(s),i.appendChild(a),i.appendChild(e.__getStyle()),e.__setupEventsListeners(o,a),e}return _createClass(n,[{key:"__createVolumeButton",value:function(){var e=this.htmlManager.createElement("div",{classList:["volume-icon-container"]}),t=this.htmlManager.createElement("button",{classList:["volume-button"]}),n=this.htmlManager.createElement("i",{classList:["gg-volume"]});return e.appendChild(t),t.appendChild(n),e}},{key:"__setupEventsListeners",value:function(e,t){var n=new TouchEventsManager;n.touchMove(document,this.__mouseMoving.bind(this)),n.touchStart(e,this.__mouseDown.bind(this)),n.touchLeave(t,this.__mouseLeaveElement.bind(this)),n.touchEnd(document,this.__mouseUp.bind(this)),n.touchLeave(document,this.__mouseLeaveDocument.bind(this)),t.onmouseenter=this.__mouseEnter.bind(this)}},{key:"__mouseEnter",value:function(){this.shadowRoot.querySelector(".volume-bar-rect").classList.add("volume-bar-rect-focus")}},{key:"__mouseLeaveDocument",value:function(){this.isVolMoving=!1}},{key:"__mouseLeaveElement",value:function(){this.isVolMoving||this.shadowRoot.querySelector(".volume-bar-rect").classList.remove("volume-bar-rect-focus")}},{key:"__mouseUp",value:function(){this.isVolMoving=!1}},{key:"__mouseMoving",value:function(e,t){if(this.isVolMoving){var n=e===TouchEventsManager.IS_TOUCH_EVENT?t.touches[0].clientX:t.clientX;this.__calculateVolumePosition(n)}}},{key:"__mouseDown",value:function(e,t){this.isVolMoving=!0;var n=e===TouchEventsManager.IS_TOUCH_EVENT?t.touches[0].clientX:t.clientX;this.__calculateVolumePosition(n)}},{key:"__calculateVolumePosition",value:function(e){var t=this.shadowRoot.querySelector(".volume-bar-rect").getBoundingClientRect(),n=(e-t.left)/t.width;this.setVolume(n*this.maxVolume)}},{key:"setVolume",value:function(e){e=(e=e<0?0:e)>this.maxVolume?this.maxVolume:e,this.volume=e,this.volumeChanged(e),this.shadowRoot.querySelector(".volume-bar-level").style.width=e+"%"}},{key:"__getStyle",value:function(){var e=document.createElement("style");return e.textContent='\n            .volume-bar-container {\n                margin-right: 0.5px;\n                cursor: pointer;\n                display: flex;\n            }\n\n            .volume-bar-container:hover,\n            .volume-bar-container:focus {\n                color: rgb(97, 87, 245);\n            }\n            \n            .volume-bar-rect {\n                display: none;\n                height: 3px;\n                background:white;\n                width: 50px;\n                margin: auto;\n                cursor: pointer;\n                transition: height 0.2s;\n            }\n\n            .volume-bar-rect:hover,\n            .volume-bar-rect:focus {\n                height: 7px;\n            }\n            \n             .volume-bar-rect-focus {\n                display: block;\n            }\n\n            .volume-bar-level {\n                height: 100%;\n                width: 0%;\n                background: rgb(97, 87, 245);\n            }\n            \n            .volume-icon-container {\n                background: rgba(0,0,0,0);\n                height: 2em;\n                padding-left: 0.4em;\n                padding-right: 0.4em;\n                border: none;\n                cursor: pointer;\n            }\n            \n            .volume-button {\n                color: white;  \n                border: none;\n                outline: none;\n                background-color: rgba(0,0,0,0);\n                height: 100%; \n                width: 2em;\n                margin: auto;\n                padding: 0;\n                cursor: pointer;\n            }\n            \n            .volume-button:hover,\n            .volume-button:focus {\n                color: rgb(97, 87, 245);\n            }\n\n            /* ICON */\n            /* ICON */\n            .gg-volume {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 8px;\n                height: 8px;\n                border: 2px solid;\n                border-right: 0;\n                -webkit-perspective: 12px;\n                perspective: 12px;\n                border-top-left-radius: 4px;\n                border-bottom-left-radius: 4px;\n                margin: 0;\n            }\n            .gg-volume::after,\n            .gg-volume::before {\n                content: "";\n                display: block;\n                box-sizing: border-box;\n                position: absolute;\n            }\n            .gg-volume::before {\n                left: 2px;\n                transform: rotateY(-90deg);\n                width: 10px;\n                height: 10px;\n                border: 2px solid;\n                border-left: 0;\n                top: -3px;\n            }\n            .gg-volume::after {\n                width: 8px;\n                height: 16px;\n                border: 6px double;\n                border-left: 0;\n                border-top-right-radius: 100px;\n                border-bottom-right-radius: 100px;\n                right: -14px;\n                top: -6px;\n            }    \n        ',e}}]),n}();customElements.define("x-volume-bar",XVolumeBar);var BottomBarController=function(){function e(t,n){_classCallCheck(this,e),this.hypervideoController=t,this.htmlManager=new HTMLManager,this.containerID=n,this.controlButton=new ControlButton(n)}return _createClass(e,[{key:"addBottomBar",value:function(e){var t=this.htmlManager.createElement("div",{classList:["bottom-controller"]});e.appendChild(t),this.playButton=this.controlButton.createControlButton("control-play-button","gg-play-button",this.__playButtonClicked.bind(this)),this.replayButton=this.controlButton.createControlButton("control-repeat-button","gg-repeat",this.__restartVideo.bind(this)),this.timeCounter=this.__createTimeCounter(),this.progressBar=this.__createProgressBar(),this.volumeBar=this.__createVolumeBar(),t.appendChild(this.playButton),t.appendChild(this.replayButton),!0===this.htmlManager.isDesktopBrowser()&&(this.fullScreenButton=this.controlButton.createControlButton("control-full-screen-button","gg-maximize",this.__toggleFullScreen.bind(this)),t.appendChild(this.fullScreenButton)),t.appendChild(this.timeCounter),t.appendChild(this.progressBar),t.appendChild(this.volumeBar)}},{key:"videoStateChanged",value:function(e,t){switch(e){case MediaManager.PLAYING:this.controlButton.changeButtonIcon("control-play-button","gg-play-pause");break;case MediaManager.PAUSED:this.controlButton.changeButtonIcon("control-play-button","gg-play-button");break;case MediaManager.LOADED:this.volumeBar.setVolume(50),this.videoLength=t.duration,this.progressBar.setMaxLength(1e3*t.duration),this.__setProgressBarTimestamps();break;case MediaManager.ENTER_FULL_SCREEN:this.controlButton.changeButtonIcon("control-full-screen-button","gg-minimize");break;case MediaManager.EXIT_FULL_SCREEN:this.controlButton.changeButtonIcon("control-full-screen-button","gg-maximize")}}},{key:"videoTimeChange",value:function(e){!1===this.progressBar.isMoving&&this.progressBar.setCurrentLength(e),this.timeCounter.currentTime=e/1e3}},{key:"__restartVideo",value:function(){this.progressBar.setCurrentLength(0),this.hypervideoController.restartVideo()}},{key:"__toggleFullScreen",value:function(){this.hypervideoController.toggleFullScreen()}},{key:"__playButtonClicked",value:function(){this.hypervideoController.play()}},{key:"__createTimeCounter",value:function(){return this.htmlManager.createElement("x-time-counter",{classList:["time-counter"]})}},{key:"__createProgressBar",value:function(){var e=this.htmlManager.createElement("x-progress-bar",{classList:["progress-container"]});return e.progressBarChanged=this.__progressBarChanged.bind(this),null!==this.videoLength&&e.setMaxLength(1e3*this.videoLength),e}},{key:"__progressBarChanged",value:function(e){this.hypervideoController.loadVideoProgress(e)}},{key:"__setProgressBarTimestamps",value:function(){var e,t=_createForOfIteratorHelper(this.tags);try{for(t.s();!(e=t.n()).done;){var n=e.value.timeConfig.timestamp;this.progressBar.addMarkerAt(1e3*n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"__createVolumeBar",value:function(){var e=this.htmlManager.createElement("x-volume-bar",{classList:["volume-bar"]});return e.volumeChanged=this.__volumeChanged.bind(this),e}},{key:"__volumeChanged",value:function(e){this.hypervideoController.setVolume(e/100)}}]),e}(),HyperimageController=function(){function e(t,n,i,a){_classCallCheck(this,e),this.containerID=n,this.imageSRC=t,this.config=i,this.htmlManager=new HTMLManager,this.tagController=new TagsController(this.containerID,null),this.mediaManager=a,this.mediaManager.mediaStateChanged=this.__mediaStateChanged.bind(this)}return _createClass(e,[{key:"__mediaStateChanged",value:function(e,t){switch(e){case MediaManager.ENTER_FULL_SCREEN:this.__fullScreenStateChanged(!0);break;case MediaManager.EXIT_FULL_SCREEN:this.__fullScreenStateChanged(!1)}}},{key:"__fullScreenStateChanged",value:function(e){var t=this;if(null!=this.imageContainer){var n=document.getElementById(this.containerID);if(!0===e)setTimeout(function(){n.style.width="100%",n.style.height="100%";var e=(window.innerWidth-t.imageElement.naturalWidth)/t.imageElement.naturalWidth,i=(window.innerHeight-t.imageElement.naturalHeight)/t.imageElement.naturalHeight>=e,a=t.imageElement.naturalWidth/t.imageElement.naturalHeight,r=window.innerHeight*a+"px",o=window.innerWidth*(1/a)+"px";console.log(r,o),t.imageElement.style.width="100%",t.imageElement.style.height="100%",t.imageContainer.style.width=i?"100%":r,t.imageContainer.style.height=i?o:"100%"},500);else{var i=this.imageElement.naturalWidth>=this.imageElement.naturalHeight,a=this.imageElement.naturalWidth/this.imageElement.naturalHeight;n.style.width=i?this.config.size.width+"px":this.config.size.height*a+"px",n.style.height=i?this.config.size.width*(1/a)+"px":this.config.size.height+"px",this.imageElement.style.width="inherit",this.imageElement.style.height="inherit",this.imageContainer.style.width="inherit",this.imageContainer.style.height="inherit"}}null!=this.tagController&&this.tagController.fullScreenStateChanged(e),null!=this.fullScreenButton&&this.fullScreenButton.isFullScreenActive(e)}},{key:"__imgLoaded",value:function(){this.__addTags();var e=document.getElementById(this.containerID),t=this.imageElement.naturalWidth>=this.imageElement.naturalHeight,n=this.imageElement.naturalWidth/this.imageElement.naturalHeight;e.style.width=t?this.config.size.width+"px":this.config.size.height*n+"px",e.style.height=t?this.config.size.width*(1/n)+"px":this.config.size.height+"px"}},{key:"createSkeleton",value:function(){var e=document.getElementById(this.containerID),t=this.htmlManager.createElement("div",{classList:["hypervideo-container"]});this.imageContainer=this.htmlManager.createElement("div",{classList:["img-container"]}),e.appendChild(t),t.appendChild(this.imageContainer),this.__addImageElement(this.imageContainer),this.tagController.addTagContainer(this.imageContainer),!0===this.htmlManager.isDesktopBrowser()&&this.__addFullScreenButton(t)}},{key:"__addFullScreenButton",value:function(e){this.fullScreenButton=this.htmlManager.createElement("x-full-screen-button");var t=this;this.fullScreenButton.clickHandler=function(){t.mediaManager.toggleFullScreen()},e.appendChild(this.fullScreenButton)}},{key:"__addImageElement",value:function(e){this.imageElement=this.htmlManager.createElement("img",{classList:["hyperimage"],src:this.imageSRC}),e.appendChild(this.imageElement),this.imageElement.addEventListener("load",this.__imgLoaded.bind(this))}},{key:"__addTags",value:function(){this.tagController.addTags(this.config.tags,!1);var e,t=_createForOfIteratorHelper(this.config.tags);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.tagController.setTagVisible(n.id,!0)}}catch(e){t.e(e)}finally{t.f()}}}]),e}(),Hypervideo=function(){function e(t){_classCallCheck(this,e),this.config=this.__assingIdToTags(t),this.videoURL=this.config.src,this.videoType=this.config.type,this.containerID=this.config.id}return _createClass(e,[{key:"__isDOMLoaded",value:function(){return null!=document&&("interactive"===document.readyState||"complete"===document.readyState)}},{key:"setupHypervideo",value:function(){if(!this.__isDOMLoaded())throw"Error: Can't setup an hypervideo if DOM is not loaded.";this.__addGlobalStyle();var t=(new MediaManagerFactory).create(this.videoType,this.containerID);this.videoType===e.IMAGE_TYPE?new HyperimageController(this.videoURL,this.containerID,this.config,t).createSkeleton():new HypervideoController(this.videoURL,this.videoType,this.containerID,t,this.config).createSkeleton()}},{key:"__assingIdToTags",value:function(e){var t=this,n=0;return null==e.tags&&(e.tags=[]),e.tags=e.tags.map(function(e){return e.id=t.containerID+"-tag-"+n++,e}),e}},{key:"__addGlobalStyle",value:function(){var e=document.createElement("style");e.textContent='\n            .hypervideo:-moz-full-screen {\n                background: black;\n                width: 100% !important;\n                height: 100% !important;\n            }\n            \n            .hypervideo:-webkit-full-screen {\n                background: black;\n                width: 100% !important;\n                height: 100% !important;\n            }\n            \n            .hypervideo:fullscreen {\n                background: black;\n                width: 100% !important;\n                height: 100% !important;\n            }\n\n            video {\n                width: 100%;\n                height: 100%;\n                background: black;\n            }\n            \n            button {\n                cursor: pointer;\n            }\n            \n            .youtube-frame {\n                width: 100%;\n                height: 100%;\n                position: absolute;\n                top: 0;\n                left: 0;\n            }\n    \n            .hyperimage {\n                width: 100%;\n                height: 100%;\n                object-fit: fill;\n            }\n            \n            .hypervideo-container {\n                position: relative;\n                width: 100%;\n                height: 100%;\n                text-align:center;\n                user-drag: none; \n                user-select: none;\n                -moz-user-select: none;\n                -webkit-user-drag: none;\n                -webkit-user-select: none;\n                -ms-user-select: none;\n            }\n    \n            .img-container {\n                margin: auto;\n                position: relative;\n                width: 100%;\n                height: 100%;\n                text-align: center;\n            }\n            \n            /* Top control bar */\n            .top-controller {\n                background: rgb(0,0,0);\n                background: linear-gradient(180deg, rgba(0,0,0,1) 30%, rgba(0,0,0,0) 100%);\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                opacity: 0;\n                transition: opacity 0.2s;\n                text-align:left;\n            }\n    \n            .top-title {\n                color:white;\n                margin: 1em;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                display: -webkit-box;\n                -webkit-line-clamp: 1;\n                -webkit-box-orient: vertical;\n            }\n    \n            .hypervideo-container:hover > .top-controller,\n            .hypervideo-container:focus > .top-controller {\n                opacity: 1;\n            }\n            \n    \n            /* Tags */\n    \n            x-tag-button {\n                pointer-events: all;\n                position: absolute;\n                width: 5%;\n                top: 50px;\n                left: 50px;\n                display: block;\n                visibility: hidden;\n            }\n    \n            .tags-container {\n                pointer-events: none;\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n            }\n    \n            /*  Bottom control bar  */\n            .bottom-controller {\n                display: flex;\n                opacity: 0;\n                justify-content: flex-start;\n                position: absolute;\n                bottom: 0;\n                left: 0;\n                right: 0;\n                background: rgb(0,0,0);\n                background: linear-gradient(0deg, rgba(0,0,0,1) 30%, rgba(0,0,0,0) 100%);\n                padding: 4px;\n                transition: opacity 0.2s;\n            }\n    \n            .hypervideo-container:hover > .bottom-controller,\n            .hypervideo-container:focus > .bottom-controller {\n                opacity: 1;\n            }\n            \n            .control-button-container {\n                background: rgba(0,0,0,0);\n                height: 2em;\n                padding-left: 0.4em;\n                padding-right: 0.4em;\n                border: none;\n                cursor: pointer;\n            }\n            \n            .control-button-container:not(:last-child) {\n                margin-right: 2px;\n            }\n            \n            .control-button {\n                color: white;  \n                border: none;\n                outline: none;\n                background-color: rgba(0,0,0,0);\n                height: 100%; \n                width: 2em;\n                margin: auto;\n                padding: 0;\n            }\n            \n            .control-button:hover,\n            .control-button:focus {\n                color: rgb(97, 87, 245);\n            }\n            \n            .progress-container {\n                flex-grow: 1;\n                margin-right: 2px;\n                height: 3px;\n                background: rgba(210,210,210,0.68);\n                align-self: center;\n                position: relative;\n                cursor: pointer; \n                transition: height 0.2s;\n            }        \n    \n            .progress-container:focus,\n            .progress-container:hover {\n                height: 5px;\n            }\n    \n            x-time-counter {\n                display: flex;\n                margin-right: 1em;\n                align-items: center;\n            }\n    \n            x-pause-screen {\n                width: 100%;\n                height: 100%;\n                margin: auto;\n                position: absolute;\n                top: 0;\n                left: 0;\n            }\n    \n            x-full-screen-button {\n                position: absolute;\n                bottom: 1em;\n                right: 1em;\n            }\n    \n            \n            /* ICONS */\n            \n            .gg-play-button {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 22px;\n                height: 22px;\n                margin: auto; /*Aquesta linia s\'ha d\'afegir*/\n            }\n            .gg-play-button::before {\n                content: "";\n                display: block;\n                box-sizing: border-box;\n                position: absolute;\n                width: 0;\n                height: 10px;\n                border-top: 5px solid transparent;\n                border-bottom: 5px solid transparent;\n                border-left: 6px solid;\n                top: 6px;\n                left: 9px;\n            }\n            \n            .gg-repeat {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                box-shadow:\n                    -2px -2px 0 0,\n                    2px 2px 0 0;\n                width: 14px;\n                height: 6px;\n                margin: auto;\n            }\n            .gg-repeat::after,\n            .gg-repeat::before {\n                content: "";\n                display: block;\n                box-sizing: border-box;\n                position: absolute;\n                width: 0;\n                height: 0;\n                border-top: 3px solid transparent;\n                border-bottom: 3px solid transparent;\n            }\n            .gg-repeat::before {\n                border-left: 5px solid;\n                top: -4px;\n                right: 0;\n            }\n            .gg-repeat::after {\n                border-right: 5px solid;\n                bottom: -4px;\n                left: 0;\n            }\n            .gg-maximize {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 14px;\n                height: 14px;\n                box-shadow:\n                    -6px -6px 0 -4px,\n                    6px 6px 0 -4px,\n                    6px -6px 0 -4px,\n                    -6px 6px 0 -4px;\n                margin: auto;\n            }\n            \n            .gg-minimize {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 4px;\n                height: 4px;\n                box-shadow:\n                    -8px -4px 0 -1px,\n                    -6px -4px 0 -1px,\n                    8px 4px 0 -1px,\n                    6px 4px 0 -1px,\n                    8px -4px 0 -1px,\n                    6px -4px 0 -1px,\n                    -8px 4px 0 -1px,\n                    -6px 4px 0 -1px;\n                margin: auto;\n            }\n            .gg-minimize::after,\n            .gg-minimize::before {\n                content: "";\n                display: block;\n                box-sizing: border-box;\n                position: absolute;\n                width: 2px;\n                height: 18px;\n                border-top: 6px solid;\n                border-bottom: 6px solid;\n                box-shadow: 18px 0 0 -2px;\n                top: -7px;\n            }\n            .gg-minimize::after {\n                left: -3px;\n            }\n            .gg-minimize::before {\n                right: -3px;\n            }\n            \n            .gg-play-pause {\n                box-sizing: border-box;\n                position: relative;\n                display: block;\n                transform: scale(var(--ggs,1));\n                width: 8px;\n                height: 10px;\n                border-left: 3px solid;\n                border-right: 3px solid;\n                margin: auto;\n            }\n        ',document.querySelector("head").appendChild(e)}}]),e}();_defineProperty(Hypervideo,"YOUTUBE_TYPE","YOUTUBE"),_defineProperty(Hypervideo,"VIDEO_TYPE","VIDEO"),_defineProperty(Hypervideo,"IMAGE_TYPE","IMAGE");var HypervideoController=function(){function e(t,n,i,a,r){_classCallCheck(this,e),this.videoLength=null,this.containerID=i,this.videoSRC=t,this.videoManager=a,this.videoType=n,this.config=r,this.htmlManager=new HTMLManager,this.videoManager.mediaStateChanged=this.__videoStateChanged.bind(this),this.bottomBarController=new BottomBarController(this,i),this.topBarController=new TopBarController(this,i),this.tagController=new TagsController(this.containerID,a)}return _createClass(e,[{key:"__videoStateChanged",value:function(e,t){switch(e){case MediaManager.LOADED:this.videoManager.setVolume(.5),this.videoLength=t.duration,this.__filterTagsByDuration(),this.bottomBarController.tags=this.config.tags,this.__addVideoTimeObserver(),this.__addTags();break;case MediaManager.ENTER_FULL_SCREEN:case MediaManager.EXIT_FULL_SCREEN:null!=this.tagController&&this.tagController.fullScreenStateChanged(e===MediaManager.ENTER_FULL_SCREEN)}this.bottomBarController.videoStateChanged(e,t)}},{key:"restartVideo",value:function(){this.videoManager.restartVideo()}},{key:"toggleFullScreen",value:function(){this.videoManager.toggleFullScreen()}},{key:"setVolume",value:function(e){this.videoManager.setVolume(e)}},{key:"loadVideoProgress",value:function(e){this.videoManager.loadProgress(e)}},{key:"play",value:function(){this.videoManager.isVideoPlaying()?this.videoManager.pause():this.videoManager.play()}},{key:"createSkeleton",value:function(){var e=document.getElementById(this.containerID),t=this.htmlManager.createElement("div",{classList:["hypervideo-container"]});this.__maintainAspectRatio(e),e.appendChild(t),this.__addVideoElement(t),this.videoType!=Hypervideo.YOUTUBE_TYPE&&this.topBarController.addTopBar(t,this.config.videoTitle),this.__addPauseScreen(t),this.tagController.addTagContainer(t),this.bottomBarController.addBottomBar(t)}},{key:"__maintainAspectRatio",value:function(t){var n=this.config.size.width>=this.config.size.height;t.style.width=n?this.config.size.width+"px":Math.floor(this.config.size.height*e.ASPECT_RATIO.x/e.ASPECT_RATIO.y)+"px",t.style.height=n?Math.floor(this.config.size.width*e.ASPECT_RATIO.y/e.ASPECT_RATIO.x)+"px":this.config.size.height+"px"}},{key:"__filterTagsByDuration",value:function(){var e=this;this.config.tags=this.config.tags.filter(function(t){return t.timeConfig.timestamp<=e.videoManager.getVideoDuration()})}},{key:"__addVideoTag",value:function(e){this.videoElementID="video-"+this.containerID;var t=this.htmlManager.createElement("video",{id:this.videoElementID,src:this.videoSRC});t.setAttribute("webkit-playsinline",""),t.setAttribute("playsinline",""),e.appendChild(t),this.videoManager.setupVideo()}},{key:"__addVideoFromYotube",value:function(e){this.videoElementID="video-"+this.containerID;var t=this.htmlManager.createElement("div",{classList:["youtube-frame"],id:this.videoElementID});e.appendChild(t),this.videoManager.addYoutubeScript(this.videoElementID,this.videoSRC)}},{key:"__addVideoElement",value:function(e){switch(this.videoType){case Hypervideo.YOUTUBE_TYPE:this.__addVideoFromYotube(e);break;default:this.__addVideoTag(e)}}},{key:"__addPauseScreen",value:function(e){var t=this.htmlManager.createElement("x-pause-screen"),n=this;t.clickHandler=function(){n.videoManager.isVideoPlaying()?n.videoManager.pause():n.videoManager.play()},e.appendChild(t)}},{key:"__addVideoTimeObserver",value:function(){var e=this,t=new Observer(function(t){e.bottomBarController.videoTimeChange(t),e.__manageTags(t/1e3)});this.videoManager.addObserver(t)}},{key:"__addTags",value:function(){this.tagController.addTags(this.config.tags,!1)}},{key:"__manageTags",value:function(e){var t,n=_createForOfIteratorHelper(this.config.tags);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.timeConfig.timestamp,r=i.timeConfig.duration,o=e>=parseInt(a)&&e<parseInt(a)+parseInt(r);this.tagController.setTagVisible(i.id,o)}}catch(e){n.e(e)}finally{n.f()}}}]),e}();_defineProperty(HypervideoController,"ASPECT_RATIO",{x:16,y:9});var TagsController=function(){function TagsController(e,t){_classCallCheck(this,TagsController),this.containerID=e,this.mediaManager=t,this.htmlManager=new HTMLManager,this.plugins=[]}return _createClass(TagsController,[{key:"addTagContainer",value:function(e){this.tagsContainer=this.htmlManager.createElement("div",{classList:["tags-container"]}),e.appendChild(this.tagsContainer)}},{key:"addTags",value:function(e,t){this.tags=e,this.__addElementsContainer();var n,i=_createForOfIteratorHelper(this.tags);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.__addTagButton(a,t);var r=null;null!=a.plugin&&(r=a.plugin),this.__createPluginForTagIfNeeded(a.id,r)}}catch(e){i.e(e)}finally{i.f()}}},{key:"setTagVisible",value:function(e,t){null!=this.plugins[e]&&this.plugins[e].isTagVisible!==t&&(!0===t?this.plugins[e].tagWillAppear():this.plugins[e].tagWillDisappear(),this.plugins[e].isTagVisible=t),document.querySelector("#"+this.containerID).querySelector("#"+e).isVisible=t}},{key:"fullScreenStateChanged",value:function(e){for(var t in this.plugins){this.plugins[t].fullScreenStateChanged(e)}this.__moveElementsContainer(e?this.tagsContainer:document.body)}},{key:"__addElementsContainer",value:function(){this.elementsContainer=this.htmlManager.createElement("div",{id:this.containerID+"-elements",style:{display:"none",position:"fixed",width:"100%",height:"100%",background:"rgba(0,0,0,0.5)",top:"0px",left:"0px",pointerEvents:"all"}}),document.body.appendChild(this.elementsContainer)}},{key:"__createTagElementsContainer",value:function(e){var t=this.htmlManager.createElement("div",{classList:["tag-element-container"],id:e+"-container",style:{display:"none",position:"fixed",width:"100%",height:"100%",background:"rgba(0,0,0,0)",top:"0px",left:"0px"}});return this.elementsContainer.appendChild(t),t}},{key:"__moveElementsContainer",value:function(e){e.appendChild(this.elementsContainer)}},{key:"__onClickTag",value:function(e){var t=e.target,n=this.__getTagFromElement(t);null!=n&&null!=this.plugins[n.id]&&this.plugins[n.id].onTagClick(e)}},{key:"__onHoverTag",value:function(e){var t=e.target,n=this.__getTagFromElement(t);null!=n&&null!=this.plugins[n.id]&&this.plugins[n.id].onTagHover(e)}},{key:"__onLeaveTag",value:function(e){var t=e.target,n=this.__getTagFromElement(t);null!=n&&null!=this.plugins[n.id]&&this.plugins[n.id].onTagLeave(e)}},{key:"__getTagFromElement",value:function(e){var t=this.tags.filter(function(t){return t.id===e.id});return null==t||t.length<=0?null:t[0]}},{key:"__createPluginForTagIfNeeded",value:function __createPluginForTagIfNeeded(tagID,plugin){if(!this.plugins.hasOwnProperty(tagID)||null==this.plugins[tagID])if(null!=plugin&&0!==Object.keys(plugin).length){var pluginName=plugin.name,classInstance=eval("new ".concat(pluginName,"()")),tagElementsContainer=this.__createTagElementsContainer(tagID);classInstance.onLoad(plugin.config,this.tagsContainer,tagElementsContainer,this.mediaManager),this.plugins[tagID]=classInstance}else this.plugins[tagID]=null}},{key:"__addTagButton",value:function(e,t){var n=this.htmlManager.createElement("x-tag-button",{id:e.id});this.tagsContainer.appendChild(n),n.hexColor=e.color?e.color:"#FFFFFF",n.position=e.position,n.isVisible=t,n.clickHandler=this.__onClickTag.bind(this),n.hoverHandler=this.__onHoverTag.bind(this),n.leaveHandler=this.__onLeaveTag.bind(this)}}]),TagsController}(),TopBarController=function(){function e(t,n){_classCallCheck(this,e),this.hypervideoController=t,this.htmlManager=new HTMLManager,this.containerID=n}return _createClass(e,[{key:"addTopBar",value:function(e,t){var n=this.htmlManager.createElement("div",{classList:["top-controller"]}),i=this.htmlManager.createElement("h3",{classList:["top-title"],textContent:t});n.appendChild(i),e.appendChild(n)}}]),e}(),MediaManagerFactory=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"create",value:function(e,t){switch(e){case Hypervideo.YOUTUBE_TYPE:return new YoutubeVideoManager(t);case Hypervideo.VIDEO_TYPE:return new VideoTagManager(t);default:return new MediaManager(t)}}}]),e}();